/*!
 * jQuery async plugin - 0.0.2
 * https://github.com/polygonplanet/jquery-async-plugin
 */
(function(d){"use strict";var f=Array.prototype.slice;
var b=function(){var i=function(){if(typeof process==="object"&&typeof process.nextTick==="function"){return process.nextTick}}(),k=function(){if(typeof setImmediate==="function"){return function(n){try{return setImmediate(n)}catch(m){return(k=l)(n)}}}}(),h=function(){var n,m;
if(typeof MessageChannel!=="function"){return false}try{n=new MessageChannel();if(!n.port1||!n.port2){return false}m=[];n.port1.onmessage=function(){m.shift()()}}catch(o){return false}return function(p){m.push(p);n.port2.postMessage("")}}(),j=function(){var m;if(typeof window!=="object"||typeof document!=="object"||typeof Image!=="function"||typeof document.addEventListener!=="function"){return false
}try{if(typeof new Image().addEventListener!=="function"){return false}}catch(n){return false}m="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";return function(s){var o,p=new Image(),q=function(){p.removeEventListener("load",q,false);
p.removeEventListener("error",q,false);if(!o){o=true;s()}};p.addEventListener("load",q,false);p.addEventListener("error",q,false);try{p.src=m}catch(r){(j=l)(s)}}}(),l=function(n,m){return setTimeout(n,m||0)};return function(m){return(i||k||h||j||l)(m)}}();var a=function(){var j=0,m=1,r=2,s=3;
function p(t){return this.init(t)}p.prototype={Deferred:p,state:s,paused:0,chained:false,unhandledErrorTimerId:null,init:function(t){var u=this;u.chain=[];u.results=[null,null];u.canceller=t;return u},cancel:function(){var t=this;if(t.state===s){t.canceller&&t.canceller(t)
}else{if(t.state===r&&k(t.results[j])){t.results[j].cancel()}}return t},callback:function(t){return o.call(this,t)},errback:function(t){return o.call(this,q(t))},addBoth:function(t){return this.addCallbacks(t,t)},addCallback:function(t){return this.addCallbacks(t,null)
},addErrback:function(t){return this.addCallbacks(null,t)},addCallbacks:function(t,u){var v=this;if(!v.chained){v.chain.push([t,u]);if(n(v.state)){i.call(v)}}return v}};p.isDeferred=k;function k(t){return t!=null&&t.Deferred===p}function n(t){return !!(t^s)}function q(t){return c(t)?t:new Error(t)
}function l(t){this.state=c(t)?m:j}function h(){var v=this.chain,u=0,t=v.length;for(;u<t;u++){if(v[u]&&d.isFunction(v[u][1])){return true}}return false}function o(t){var u=this;l.call(u,t);u.results[u.state]=t;return i.call(u)}function i(){var x=this,v=x.chain,u=x.results[x.state],t,w,z;
if(x.unhandledErrorTimerId&&n.call(x)&&h.call(x)){clearTimeout(x.unhandledErrorTimerId);delete x.unhandledErrorTimerId}while(v.length&&!x.paused){w=v.shift()[x.state];if(!w){continue}try{u=w.call(x,u);l.call(x,u);if(k(u)){t=function(A){o.call(x,A);x.paused--;if(!x.paused&&n(x.state)){i.call(x)
}};x.paused++}}catch(y){x.state=m;u=q(y);if(!h.call(x)){z=true}}}x.results[x.state]=u;if(t&&x.paused){u.addBoth(t);u.chained=true}if(z){x.unhandledErrorTimerId=setTimeout(function(){try{throw u}finally{delete x.unhandledErrorTimerId}},0)}return x}return p}();(function e(){var k="addCallback addErrback addCallbacks addBoth".split(" ");
function j(m,l){d.each(k,function(n,o){m[o]=function(){return l[o].apply(l,arguments)}});return m}function i(n,m){n._deferred=m;j(n,m);n.callback=function(){return m.callback.apply(m,arguments)};n.errback=function(){return m.errback.apply(m,arguments)};m.promise=function(){return this
};var l=n.promise;n.promise=function(){var o=l.apply(this,arguments);var q=o._deferred=this._deferred;return j(o,q)};return n}var h=d.Deferred;d.Deferred=function(){var l=new a();return i(h.apply(this,arguments),l)}}());d.async=function(j){var k=new a();var i,h;
if(d.isFunction(j)){i=f.call(arguments,1);k.addCallback(function(){return j.apply(this,i)})}else{h=j}b(function(){k.callback(h)});return k};d.extend(d.async,{Deferred:a,isError:c,isDeferred:a.isDeferred,isjQueryDeferred:g,succeed:function(){var h=new a();return h.callback.apply(h,arguments)
},fail:function(){var h=new a();return h.errback.apply(h,arguments)},maybeDeferred:function(i){var h,j;try{if(c(i)){throw i}if(d.isFunction(i)){j=i.apply(i,f.call(arguments,1))}else{j=i}if(d.async.isDeferred(j)){h=j}else{h=d.async.succeed(j)}}catch(k){h=d.async.fail(k)
}return h},maybeDeferreds:function(){return d.map(f.call(arguments),function(h){return d.async.maybeDeferred(h)})},wait:function(l,j){var h;var i=f.call(arguments,1);var k=new a(function(){clearTimeout(h)});h=setTimeout(function(){k.callback()},Math.floor(((l-0)||0)*1000));
if(i.length){k.addCallback(function(){return j})}return k},callLater:function(j,i){var h=f.call(arguments,2);return d.async.wait(j).addCallback(function(){if(d.async.isDeferred(i)){return i.callback.apply(i,h)}if(d.isFunction(i)){return i.apply(i,h)}return i})},till:function(j){var k=new a();
var i=f.call(arguments,1);var h=13;return d.async(function l(){var m=this;var n=d.now();if(j&&!j.apply(this,i)){setTimeout(function(){l.call(m)},Math.min(1000,h+(d.now()-n)))}else{k.callback()}return k})}});function c(h){return h!=null&&(h instanceof Error||d.type(h)==="error")
}function g(h){return h!=null&&d.isFunction(h.always)}}(jQuery));
